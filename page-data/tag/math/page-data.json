{"componentChunkName":"component---src-templates-tags-jsx","path":"/tag/math","result":{"data":{"site":{"siteMetadata":{"title":"sami.pw"}}},"pageContext":{"posts":[{"html":"<h3>Automatic failover using Interlock and CI/CDs</h3>\n<p>In the last few weeks in the middle of the lockdown i was bored and i (re)started playing around <strong>Go</strong> since i was a bit rusty. <br>\nMy main goal was to <strong>automagically</strong> failover all my static sites from Github &#x26; other public hosting sites back and forth in order to maintain an active DR plan when one of my providers is going offline because of connectivity or any other outage/maintenance.</p>\n<p> So before going into the blog post here is a quick overview: <br> <br> <br></p>\n<p><img src=\"https://raw.githubusercontent.com/fnzv/fnzv.github.io/master/imgs/interlock-scheme.png\"> <br></p>\n<p>You can check it also on the readme there: <a href=\"https://github.com/fnzv/interlock\">https://github.com/fnzv/interlock</a></p>\n<p>When i started writing the code this time i tried to force myself to avoid the <strong>bad and ugly \"exec shell\"</strong> in order to be able to create a more thin Golang docker image (260MiB)</p>\n<p>So to avoid making you read all the README.md i could sum up all the code in this sentence:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;Interlock is a DNS failover and management tool based on Cloudflare APIs&quot;</code></pre></div>\n<p>Maybe i reinvented the wheel because i could have used (paid) the built-in healthcheck of CF or any other DNS provider but i wanted to learn and research\nunderneath in order to get my hands \"dirty\" and mess around Go again</p>\n<p>This piece of code is supposed to run also inside your k8s cluster in order to gather metrics versus your ingresses and monitor internal\nlatency between your cluster nodes, all the metrics are gathered and sent directly to the configured InfluxDB host</p>\n<p>Here you can see an example visualization made in a few minutes to monitor some of my public static sites latency</p>\n<p align=\"center\">\n  <img src=\"https://raw.githubusercontent.com/fnzv/fnzv.github.io/master/imgs/interlock-grafana.png?raw=true\" width=\"1100\" height=\"250\">\n</p>\n<p>This data could be used to generate post-hook events in order to run external bash scripts via <a href=\"https://github.com/adnanh/webhook\">https://github.com/adnanh/webhook</a> (kudos to the dev) + grafana webhooks from Alerts</p>\n<h3>Cool but how can i use it right now?</h3>\n<p>Well this is up to you depending on the use case, to run a interlock generic example with a \"famous\" Public CI/CD you can follow these instructions: </p>\n<ol>\n<li>Clone the Git repo or import directly from your <strong>Gitlab</strong> account\n<br><br></li>\n<li>Setup your ENV variables (masked) under Settings -> CI/CD -> Variables (Expand) <br>\n<strong>Keep the dry run env variables</strong> in order to avoid any changes to your CF account <br>\nTelegram and InfluxDB variables can be kept empty<br>\nJust in case keep your repo privacy settings to <strong>private</strong>\n<br><br></li>\n<li>Change your configuration under interlock.conf  <br>\nSet your origins <br>\nCommit those changes with the commit message \"build\" in order to prepare your Docker image\n<br><br></li>\n<li>Go under CI/CD -> Pipelines and try to run the already configured one by pressing \"Run pipeline\" <br>\nIf everything is set up properly you will see all green\n<br><br> </li>\n<li>Schedule your pipeline in order to run multiple times using crontab syntax <strong>(if you don't speak crontabese</strong> you can go <a href=\"https://crontab.guru/\">https://crontab.guru/</a>), for example */15 * * * *  <br>\nTo run only one stage of the pipeline you must set the ENV variable CRON to TRUE</li>\n</ol>\n<p>Leaving you with this CI/CD meme here, if you have any question or suggestions you can contact me or open a pull request</p>\n<p align=\"center\">\n  <img src=\"https://raw.githubusercontent.com/fnzv/fnzv.github.io/master/imgs/cicd-meme.jpg?raw=true\" width=\"290\" height=\"300\">\n</p>\n<p>Links and Resources:<br></p>\n<ul>\n<li><a href=\"https://docs.gitlab.com/ee/ci/pipelines/schedules.html\">Gitlab CI/CD documentation</a><br></li>\n<li><a href=\"https://github.com/cloudflare/cloudflare-go\">Cloudflare-go library</a>  <br></li>\n<li>[Git repo] (<a href=\"https://github.com/fnzv/interlock\">https://github.com/fnzv/interlock</a>) <br></li>\n</ul>\n<p>wq!<br>\nCTRL+R(reverse-i-search)`add': git add . &#x26;&#x26; git commit -m \"Initial Commit\" &#x26;&#x26; git push origin master </p>","id":"b926c8dc-dbd6-5587-be22-de1f05489f4f","timeToRead":3,"frontmatter":{"date":"May 30, 2020","path":"/blog/2021-03-19-benford-law-checker","tags":"math","title":"Testing Benford's Law on COVID-19 italian Datasets"}}],"tag":"math","pagesSum":1,"page":1}}}